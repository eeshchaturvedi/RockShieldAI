<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" href="/static/assets/Untitled-removebg-preview.png" type="image/x-icon">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Risk Analysis - Rockfall Prediction</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<style>
    .logo {
            
    display: flex;
    align-items: center;
    gap: 20px; /* space between image and text */
    font-size: 1.3rem;
    font-weight: 700;
    letter-spacing: 2px;
    background: linear-gradient(135deg, #fff, #ccc);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.logo-img {
    width: 40px;  /* adjust as needed */
    height: 40px; /* keep it square */
    object-fit: contain;
    transition: transform 0.3s ease; /* smooth transition */
}

.logo-img:hover {
    transform: scale(1.5); /* 20% bigger on hover */
}
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Poppins', sans-serif;
        color: white;
        background: linear-gradient(135deg, #0a0a0a, #1a1a1a);
        overflow-x: hidden;
        min-height: 100vh;
    }
    .background{
        position: absolute;
        top: -60%;
        opacity: 0.4;
        z-index: -100;
    }

    /* --- Navigation Bar --- */
    .navbar {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        padding: 20px 50px;
        box-sizing: border-box;
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: rgba(0, 0, 0, 0.9);
        backdrop-filter: blur(20px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        z-index: 1000;
        transition: all 0.3s ease;
    }

    .logo {
        font-size: 1.3rem;
        font-weight: 700;
        letter-spacing: 2px;
        background: linear-gradient(135deg, #fff, #ccc);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .nav-links {
        list-style: none;
        display: flex;
        gap: 30px;
        margin: 0;
        padding: 0;
    }

    .nav-links a {
        color: rgba(255, 255, 255, 0.9);
        text-decoration: none;
        font-weight: 400;
        font-size: 0.9rem;
        letter-spacing: 1px;
        transition: all 0.3s ease;
        position: relative;
    }

    .nav-links a::after {
        content: '';
        position: absolute;
        bottom: -5px;
        left: 0;
        width: 0;
        height: 2px;
        background: linear-gradient(135deg, #fff, #ccc);
        transition: width 0.3s ease;
    }

    .nav-links a:hover {
        color: #fff;
    }

    .nav-links a:hover::after {
        width: 100%;
    }

    /* --- Main Content Container --- */
    .main-container {
        margin-top: 100px;
        padding: 3rem 4%;
        min-height: calc(100vh - 100px);
    }

    .page-header {
        text-align: center;
        margin-bottom: 4rem;
        animation: fadeInUp 1s ease-out;
    }

    .page-header h1 {
        font-size: 4rem;
        font-weight: 700;
        background: linear-gradient(135deg, #ffffff, #e0e0e0);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 1rem;
        letter-spacing: -2px;
    }

    .page-header p {
        font-size: 1.2rem;
        color: rgba(255, 255, 255, 0.7);
        letter-spacing: 1px;
    }

    /* --- Analysis Dashboard --- */
    .analysis-dashboard {
        display: grid;
        grid-template-columns: 1fr 2fr 2fr;
        gap: 4rem;
        max-width: 1400px;
        margin: 0 auto;
        animation: fadeInUp 1.2s ease-out 0.3s both;
    }

    /* --- Risk Meter Section --- */
    .risk-meter-section {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 2rem;
    }

    .risk-meter-container {
        position: relative;
        background: rgba(0, 0, 0, 0.7);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 25px;
        padding: 2rem 1.5rem;
        backdrop-filter: blur(10px);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        display: flex;
    flex-direction: column;
    align-items: center;
    }

    .risk-meter-title {
        text-align: center;
        margin-bottom: 2rem;
    }

    .risk-meter-title h2 {
        font-size: 1.5rem;
        font-weight: 600;
        color: #fff;
        margin-bottom: 0.5rem;
    }

    .risk-meter-title p {
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.6);
        letter-spacing: 1px;
        text-transform: uppercase;
    }

    .risk-meter {
        position: relative;
        width: 60px;
        height: 400px;
        background: linear-gradient(to bottom,  
            #ff4444 0%,  
            #ff6666 20%,  
            #ffaa44 40%,  
            #ffdd44 60%,  
            #88dd44 80%,  
            #44dd44 100%);
        border-radius: 30px;
        overflow: hidden;
        box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.3);
        border: 2px solid rgba(255, 255, 255, 0.2);
    }

    .risk-meter::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(to right,  
            rgba(255, 255, 255, 0.1),  
            transparent 30%,  
            transparent 70%,  
            rgba(0, 0, 0, 0.1));
        pointer-events: none;
    }

    .risk-fill {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 0%;
        background: linear-gradient(to top,  
            rgba(0, 0, 0, 0.6),  
            rgba(0, 0, 0, 0.3) 50%,  
            transparent);
        transition: height 2s cubic-bezier(0.4, 0, 0.2, 1);
        border-radius: 0 0 28px 28px;
    }

    .risk-indicators {
        position: absolute;
        right: -40px;
        top: 0;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        padding: 10px 0;
    }

    .risk-indicator {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 0.9rem; /* Increased size */
    color: #fff; /* Made fully white for high contrast */
    font-weight: 600; /* Made slightly bolder */
    text-shadow: 0 0 5px rgba(0, 0, 0, 0.5); /* Adds a subtle glow to pop the text */
}

    .risk-indicator::before {
        content: '';
        width: 15px;
        height: 2px;
        background: rgba(255, 255, 255, 0.5);
    }

    .risk-value {
        text-align: center;
        margin-top: 2rem;
    }

    .risk-percentage {
        font-size: 3rem;
        font-weight: 700;
        background: linear-gradient(135deg, #fff, #ccc);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 0.5rem;
        transition: all 0.3s ease;
    }

    .risk-status {
        font-size: 1rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 2px;
        padding: 0.5rem 1rem;
        border-radius: 20px;
        transition: all 0.3s ease;
    }

    /* Risk status colors */
    .risk-low {  
        color: #44dd44;  
        border: 1px solid rgba(68, 221, 68, 0.3);
        background: rgba(68, 221, 68, 0.1);
    }
    .risk-moderate {  
        color: #ffdd44;  
        border: 1px solid rgba(255, 221, 68, 0.3);
        background: rgba(255, 221, 68, 0.1);
    }
    .risk-high {  
        color: #ffaa44;  
        border: 1px solid rgba(255, 170, 68, 0.3);
        background: rgba(255, 170, 68, 0.1);
    }
    .risk-critical {  
        color: #ff4444;  
        border: 1px solid rgba(255, 68, 68, 0.3);
        background: rgba(255, 68, 68, 0.1);
    }

    /* --- Analysis Data Section --- */
    .analysis-data-section {
        display: flex;
        flex-direction: column;
        gap: 2rem;
    }

    .data-card {
        background: rgba(0, 0, 0, 0.7);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 15px;
        padding: 2rem;
        backdrop-filter: blur(10px);
        transition: all 0.3s ease;
    }

    .data-card:hover {
        background: rgba(0, 0, 0, 0.55);  
        border-color: rgba(255, 255, 255, 0.2);
        transform: translateY(-2px);
    }

    .data-card h3 {
        font-size: 1.3rem;
        font-weight: 600;
        color: #fff;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .data-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
    }

    .data-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.8rem;
        background: rgba(255, 255, 255, 0.03);
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.05);
    }

    .data-label {
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.7);
        font-weight: 400;
    }

    .data-value {
        font-size: 1rem;
        color: #fff;
        font-weight: 600;
    }

    .model-info {
        margin-top: 1rem;
        padding: 1rem;
        background: rgba(255, 255, 255, 0.03);
        border-radius: 10px;
        border-left: 4px solid rgba(255, 255, 255, 0.3);
    }

    .model-info p {
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.8);
        line-height: 1.6;
    }

    /* --- Simulation Section --- */
    .simulation-section {
        display: flex;
        flex-direction: column;
        gap: 2rem;
    }

    .simulation-container {
        background: rgba(0, 0, 0, 0.7);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 15px;
        padding: 2rem;
        backdrop-filter: blur(10px);
        min-height: 500px;
        position: relative;
        overflow: hidden;
    }

    .simulation-header {
        text-align: center;
        margin-bottom: 2rem;
    }

    .simulation-header h3 {
        font-size: 1.5rem;
        font-weight: 600;
        color: #fff;
        margin-bottom: 0.5rem;
    }

    .simulation-header p {
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.6);
        letter-spacing: 1px;
    }

    .simulation-placeholder {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 400px;
        border: 2px dashed rgba(255, 255, 255, 0.2);
        border-radius: 10px;
        color: rgba(255, 255, 255, 0.5);
        font-size: 1.1rem;
        text-align: center;
        line-height: 1.6;
        background: radial-gradient(ellipse at center, rgba(255, 255, 255, 0.02), transparent);
    }

    .simulation-controls {
        display: flex;
        justify-content: center;
        gap: 1rem;
        margin-top: 2rem;
    }

    .sim-button {
        padding: 0.8rem 2rem;
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 25px;
        color: rgba(255, 255, 255, 0.9);
        font-family: 'Poppins', sans-serif;
        font-size: 0.9rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .sim-button:hover {
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.08));
        border-color: rgba(255, 255, 255, 0.3);
        transform: translateY(-2px);
    }

    .sim-button.primary {
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.1));
        border-color: rgba(255, 255, 255, 0.4);
    }

    /* --- Action Buttons --- */
    .action-buttons {
        display: flex;
        justify-content: center;
        gap: 2rem;
        margin-top: 4rem;
        grid-column: 1 / -1;
    }

    .action-button {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1.2rem 2.5rem;
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.05));
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 50px;
        color: white;
        font-family: 'Poppins', sans-serif;
        font-size: 0.95rem;
        font-weight: 600;
        letter-spacing: 2px;
        text-transform: uppercase;
        cursor: pointer;
        transition: all 0.4s ease;
        text-decoration: none;
        position: relative;
        overflow: hidden;
    }

    .action-button::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.6s ease;
    }

    .action-button:hover::before {
        left: 100%;
    }

    .action-button:hover {
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.25), rgba(255, 255, 255, 0.1));
        border-color: rgba(255, 255, 255, 0.5);
        box-shadow: 0 15px 40px rgba(255, 255, 255, 0.1);
        transform: translateY(-3px);
    }

    .action-button.secondary {
        background: transparent;
        border-color: rgba(255, 255, 255, 0.2);
        color: rgba(255, 255, 255, 0.8);
    }

    .action-button.secondary:hover {
        background: rgba(255, 255, 255, 0.05);
        border-color: rgba(255, 255, 255, 0.4);
        color: rgba(255, 255, 255, 0.95);
    }

    /* --- Animations --- */
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(50px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes pulse {
        0%, 100% { opacity: 0.6; }
        50% { opacity: 1; }
    }

    .loading-indicator {
        animation: pulse 2s infinite;
    }

    /* --- Responsive Design --- */
    @media (max-width: 1200px) {
        .analysis-dashboard {
            grid-template-columns: 1fr;
            gap: 3rem;
        }
        
        .risk-meter-section {
            order: -1;
        }
    }

    @media (max-width: 768px) {
        .navbar {
            flex-direction: column;
            padding: 15px 20px;
        }

        .nav-links {
            margin-top: 15px;
            gap: 20px;
        }

        .main-container {
            padding: 2rem 5%;
            margin-top: 120px;
        }

        .page-header h1 {
            font-size: 2.5rem;
        }

        .data-grid {
            grid-template-columns: 1fr;
        }

        .action-buttons {
            flex-direction: column;
            align-items: center;
        }

        .action-button {
            width: 100%;
            justify-content: center;
        }

        .risk-meter {
            height: 300px;
        }
    }

    @media (max-width: 480px) {
        .page-header h1 {
            font-size: 2rem;
        }

        .risk-percentage {
            font-size: 2.5rem;
        }

        .simulation-container {
            min-height: 300px;
        }

        .simulation-placeholder {
            height: 250px;
            font-size: 1rem;
        }
    }
    
    /* --- Modal Styles (Styled to match original UI) --- */
    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(5px);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 2000;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease, visibility 0.3s ease;
    }
    .modal-overlay.active {
        opacity: 1;
        visibility: visible;
    }
    .modal-content {
        background: rgba(0, 0, 0, 0.8);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 15px;
        padding: 2rem;
        backdrop-filter: blur(10px);
        width: 90%;
        max-width: 500px;
        transform: scale(0.95);
        transition: transform 0.3s ease;
    }
    .modal-overlay.active .modal-content {
        transform: scale(1);
    }
    .modal-header {
        font-size: 1.5rem;
        font-weight: 600;
        color: #fff;
        margin-bottom: 1rem;
    }
    .modal-body {
        color: rgba(255, 255, 255, 0.8);
        margin-bottom: 2rem;
    }
    .modal-actions {
        display: flex;
        justify-content: flex-end;
        gap: 1rem;
    }
    .modal-button {
        padding: 0.6rem 1.5rem;
        border-radius: 20px;
        font-family: 'Poppins', sans-serif;
        font-size: 0.9rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 1px;
    }
    .modal-button.cancel {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: rgba(255, 255, 255, 0.9);
    }
     .modal-button.cancel:hover {
        background: rgba(255, 255, 255, 0.15);
        border-color: rgba(255, 255, 255, 0.3);
    }
    .modal-button.confirm {
         background: #ff4444;
         border: 1px solid rgba(255, 68, 68, 0.3);
         color: white;
    }
    .modal-button.confirm:hover {
        background: #ff6666;
    }

</style>

<body>
    <img class ="background" src="/static/assets/bg-img.jpg>"
    <!-- Navigation Bar -->
    <header>
    <nav class="navbar">
        <div class="logo">
            <img src="/static/assets/Untitled-removebg-preview.png" alt="Logo" class="logo-img">
            ROCKFALL PREDICTION
        </div>
        <ul class="nav-links">
            <li><a href="{{ url_for('home') }}">HOME</a></li>
            <li><a href="#analysis">ANALYSIS</a></li>
            <li><a href="#simulation">SIMULATION</a></li>
            <li><a href="#report">REPORT</a></li>
        </ul>
    </nav>
</header>

    <!-- Main Content -->
    <main class="main-container">
        <!-- Page Header -->
        <div class="page-header">
            <h1>Risk Analysis Results</h1>
            <p>Comprehensive rockfall probability assessment and simulation</p>
        </div>

        <!-- Analysis Dashboard -->
        <div class="analysis-dashboard">
            <!-- Risk Meter Section -->
            <div class="risk-meter-section">
                <div class="risk-meter-container">
                    <div class="risk-meter-title">
                        <h2>Risk Level</h2>
                        <p>Current Assessment</p>
                    </div>
                    <div class="risk-meter">
                        <div class="risk-fill" id="riskFill"></div>
                        <div class="risk-indicators">
                            <div class="risk-indicator">Critical</div>
                            <div class="risk-indicator">High</div>
                            <div class="risk-indicator">Moderate</div>
                            <div class="risk-indicator">Low</div>
                            <div class="risk-indicator">Minimal</div>
                        </div>
                    </div>
                    <div class="risk-value">
                        <div class="risk-percentage" id="riskPercentage">0%</div>
                        <div class="risk-status" id="riskStatus">Calculating...</div>
                    </div>
                </div>
            </div>

            <!-- Analysis Data Section -->
            <div class="analysis-data-section">
                <div class="data-card">
                    <h3>Environmental Parameters</h3>
                    <div class="data-grid">
                        <div class="data-item">
                            <span class="data-label">Rainfall</span>
                            <span class="data-value" id="rainfall-value">--</span>
                        </div>
                        <div class="data-item">
                            <span class="data-label">Wind Speed</span>
                            <span class="data-value" id="windspeed-value">--</span>
                        </div>
                        <div class="data-item">
                            <span class="data-label">Temperature</span>
                            <span class="data-value" id="temperature-value">--</span>
                        </div>
                        <div class="data-item">
                            <span class="data-label">Humidity</span>
                            <span class="data-value" id="humidity-value">--</span>
                        </div>
                    </div>
                </div>

                <div class="data-card">
                    <h3>Geological Parameters</h3>
                    <div class="data-grid">
                        <div class="data-item">
                            <span class="data-label">Strain</span>
                            <span class="data-value" id="strain-value">--</span>
                        </div>
                        <div class="data-item">
                            <span class="data-label">Pore Pressure</span>
                            <span class="data-value" id="pressure-value">--</span>
                        </div>
                        <div class="data-item">
                            <span class="data-label">Displacement</span>
                            <span class="data-value" id="displacement-value">--</span>
                        </div>
                        <div class="data-item">
                            <span class="data-label">Seismic Activity</span>
                            <span class="data-value" id="seismic-value">--</span>
                        </div>
                    </div>
                </div>

                <div class="data-card">
                    <h3>Model Information</h3>
                    <div class="model-info">
                        <p><strong>Model Type:</strong> Advanced Neural Network</p>
                        <p><strong>Training Accuracy:</strong> 94.7%</p>
                        <p><strong>Validation Score:</strong> 92.3%</p>
                        <p><strong>Last Updated:</strong> <span id="model-date">--</span></p>
                        <p><strong>Confidence Level:</strong> <span id="confidence-level">--</span></p>
                    </div>
                </div>
            </div>

            <!-- Simulation Section -->
            <div class="simulation-section">
                <div class="simulation-container">
                    <div class="simulation-header">
                        <h3>Rockfall Simulation</h3>
                        <p>3D visualization of potential rockfall scenarios</p>
                    </div>
                    <div class="simulation-placeholder loading-indicator" id="simulation-placeholder"></div>
                    <div class="simulation-controls">
                        <!--<button class="sim-button primary" onclick="startSimulation()">Start Simulation</button>
                        <button class="sim-button" onclick="resetSimulation()">Reset</button>
                        <button class="sim-button" onclick="exportSimulation()">Export</button>-->
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <a href="#" class="action-button" onclick="generateReport()">
                <span>Generate Report</span>
            </a>
            <a href="#" class="action-button secondary" onclick="newAnalysis()">
                <span>New Analysis</span>
            </a>
        </div>
    </main>
    
    <!-- Modal HTML -->
    <div id="appModal" class="modal-overlay">
        <div class="modal-content">
            <h3 id="modalTitle" class="modal-header"></h3>
            <p id="modalMessage" class="modal-body"></p>
            <div id="modalActions" class="modal-actions">
                <button id="modalCancel" class="modal-button cancel">Close</button>
                <button id="modalConfirm" class="modal-button confirm">Confirm</button>
            </div>
        </div>
    </div>


    <script>
    document.addEventListener('DOMContentLoaded', function () {
        // âœ… FIX: Convert Jinja output into a JS object safely
        let analysisData = {};
        try {
            analysisData = JSON.parse(`{{ analysis | tojson | safe }}`);
        } catch (e) {
            console.warn("No analysis data available or parsing failed.", e);
        }

        // Populate the page if data exists
        if (analysisData && Object.keys(analysisData).length > 0) {
            populateData(analysisData);
        } else {
            // If no data, show an initial message
            document.getElementById('riskStatus').textContent = 'No Data';
            document.getElementById('riskPercentage').textContent = '--%';
        }

        // Modal functionality
        const modal = document.getElementById('appModal');
        const modalCancel = document.getElementById('modalCancel');
        
        modalCancel.onclick = () => modal.classList.remove('active');
        modal.onclick = (e) => {
            if (e.target === modal) {
                modal.classList.remove('active');
            }
        };
    });

    // --- Risk status function ---
    function getRiskStatus(percentage) {
        if (percentage >= 80) return { status: 'Critical', class: 'risk-critical' };
        if (percentage >= 60) return { status: 'High', class: 'risk-high' };
        if (percentage >= 30) return { status: 'Moderate', class: 'risk-moderate' };
        return { status: 'Low', class: 'risk-low' };
    }

    // --- Risk meter animation ---
    function animateRiskMeter(percentage) {
        const riskFill = document.getElementById('riskFill');
        const riskPercentage = document.getElementById('riskPercentage');
        const riskStatus = document.getElementById('riskStatus');

        const riskInfo = getRiskStatus(percentage);

        setTimeout(() => {
            riskFill.style.height = `${percentage}%`;
        }, 500);

        let currentPercentage = 0;
        const increment = percentage / 100;
        const counter = setInterval(() => {
            currentPercentage += increment;
            riskPercentage.textContent = Math.floor(currentPercentage) + '%';

            if (currentPercentage >= percentage) {
                clearInterval(counter);
                riskPercentage.textContent = percentage + '%';
                riskStatus.textContent = riskInfo.status;
                riskStatus.className = `risk-status ${riskInfo.class}`;
            }
        }, 20);
    }

    // --- Populate analysis data ---
    function populateData(data) {
        if (!data || Object.keys(data).length === 0) return;

        // Environmental
        document.getElementById('rainfall-value').textContent = data.Rainfall_mm + " mm";
        document.getElementById('windspeed-value').textContent = data.Windspeed_mps + " m/s";
        document.getElementById('temperature-value').textContent = data.Temperature_C + " Â°C";
        document.getElementById('humidity-value').textContent = data.Humidity + "%";

        // Geological
        document.getElementById('strain-value').textContent = data.Strain + " Î¼Îµ";
        document.getElementById('pressure-value').textContent = data.Pore_Pressure + " kPa";
        document.getElementById('displacement-value').textContent = data.Displacement + " m";
        document.getElementById('seismic-value').textContent = data.Seismic + " Hz";

        // Model info
        document.getElementById('model-date').textContent = new Date().toLocaleDateString();
        document.getElementById('confidence-level').textContent = data.Confidence + "%";

        // Animate risk meter
        animateRiskMeter(data.riskPercentage);
    }

    // --- Modal Control ---
    function showModal(title, message, isConfirm = false, onConfirm = null) {
        const modal = document.getElementById('appModal');
        document.getElementById('modalTitle').textContent = title;
        document.getElementById('modalMessage').textContent = message;
        
        const confirmBtn = document.getElementById('modalConfirm');
        if (isConfirm) {
            confirmBtn.style.display = 'block';
            const newConfirmBtn = confirmBtn.cloneNode(true);
            confirmBtn.parentNode.replaceChild(newConfirmBtn, confirmBtn);
            newConfirmBtn.onclick = () => {
                if(onConfirm) onConfirm();
                modal.classList.remove('active');
            };
        } else {
            confirmBtn.style.display = 'none';
        }
        modal.classList.add('active');
    }

    // --- Simulation Functions ---
    function startSimulation() {
        const placeholder = document.getElementById('simulation-placeholder');
        placeholder.innerHTML = `
            ðŸŽ¬<br><br>
            Simulation Running...<br>
            <small>Analyzing rockfall trajectories and impact zones</small>
        `;
        placeholder.style.background = 'radial-gradient(ellipse at center, rgba(68, 221, 68, 0.1), transparent)';
    }

    function resetSimulation() {
        const placeholder = document.getElementById('simulation-placeholder');
        placeholder.innerHTML = ''; // Clear content
        placeholder.style.background = 'radial-gradient(ellipse at center, rgba(255, 255, 255, 0.02), transparent)';
    }

    function exportSimulation() {
        showModal('Export Simulation', 'Simulation data exported successfully!');
    }

    function generateReport() {
        showModal('Generate Report', 'Generating comprehensive risk assessment report...');
    }

    function newAnalysis() {
        showModal(
            'Start New Analysis?',
            'This will clear the current results and redirect you to the homepage. Are you sure?',
            true,
            () => {
                window.location.href = '/reset';
            }
        );
    }
</script>
</body>
</html>
